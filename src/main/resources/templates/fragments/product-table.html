<div style="margin-bottom: var(--wa-spacing-md);">
    <label for="pageSize" style="margin-right: var(--wa-spacing-md);">Items per page:</label>
    <select id="pageSize" 
            th:attr="data-sort-by=${sortBy}, data-order=${order}"
            style="padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;">
        <option value="10" th:selected="${pageSize == 10}">10</option>
        <option value="50" th:selected="${pageSize == 50}">50</option>
        <option value="100" th:selected="${pageSize == 100}">100</option>
    </select>
</div>

<table>
    <thead>
        <tr>
            <th>
                <a href="#" 
                   th:hx-get="@{/products(sortBy='id', order=${(sortBy == 'id' and order == 'asc') ? 'desc' : 'asc'}, page=${page}, pageSize=${pageSize})}" 
                   hx-target="#product-table-container" 
                   hx-swap="innerHTML"
                   style="text-decoration: none; color: inherit; cursor: pointer;">
                    ID
                    <span th:if="${sortBy == 'id'}">
                        <span th:text="${order == 'asc' ? '↑' : '↓'}"></span>
                    </span>
                </a>
            </th>
            <th>
                <a href="#" 
                   th:hx-get="@{/products(sortBy='title', order=${(sortBy == 'title' and order == 'asc') ? 'desc' : 'asc'}, page=${page}, pageSize=${pageSize})}" 
                   hx-target="#product-table-container" 
                   hx-swap="innerHTML"
                   style="text-decoration: none; color: inherit; cursor: pointer;">
                    Title
                    <span th:if="${sortBy == 'title'}">
                        <span th:text="${order == 'asc' ? '↑' : '↓'}"></span>
                    </span>
                </a>
            </th>
            <th>
                <a href="#" 
                   th:hx-get="@{/products(sortBy='price', order=${(sortBy == 'price' and order == 'asc') ? 'desc' : 'asc'}, page=${page}, pageSize=${pageSize})}" 
                   hx-target="#product-table-container" 
                   hx-swap="innerHTML"
                   style="text-decoration: none; color: inherit; cursor: pointer;">
                    Price
                    <span th:if="${sortBy == 'price'}">
                        <span th:text="${order == 'asc' ? '↑' : '↓'}"></span>
                    </span>
                </a>
            </th>
            <th>
                <a href="#" 
                   th:hx-get="@{/products(sortBy='vendor', order=${(sortBy == 'vendor' and order == 'asc') ? 'desc' : 'asc'}, page=${page}, pageSize=${pageSize})}" 
                   hx-target="#product-table-container" 
                   hx-swap="innerHTML"
                   style="text-decoration: none; color: inherit; cursor: pointer;">
                    Vendor
                    <span th:if="${sortBy == 'vendor'}">
                        <span th:text="${order == 'asc' ? '↑' : '↓'}"></span>
                    </span>
                </a>
            </th>
            <th>
                <a href="#" 
                   th:hx-get="@{/products(sortBy='created_at', order=${(sortBy == 'created_at' and order == 'asc') ? 'desc' : 'asc'}, page=${page}, pageSize=${pageSize})}" 
                   hx-target="#product-table-container" 
                   hx-swap="innerHTML"
                   style="text-decoration: none; color: inherit; cursor: pointer;">
                    Created
                    <span th:if="${sortBy == 'created_at'}">
                        <span th:text="${order == 'asc' ? '↑' : '↓'}"></span>
                    </span>
                </a>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="product : ${products}">
            <td th:text="${product.id}"></td>
            <td th:text="${product.title}"></td>
            <td th:text="${product.price != null ? #numbers.formatDecimal(product.price, 1, 2) : '-'}"></td>
            <td th:text="${product.vendor ?: '-'}"></td>
            <td th:text="${product.createdAt != null ? #temporals.format(product.createdAt, 'yyyy-MM-dd HH:mm') : '-'}"></td>
        </tr>
    </tbody>
</table>

<div style="margin-top: var(--wa-spacing-lg); display: flex; justify-content: space-between; align-items: center;">
    <div>
        <span th:text="'Showing ' + ${page * pageSize + 1} + ' to ' + ${(page + 1) * pageSize > totalCount ? totalCount : (page + 1) * pageSize} + ' of ' + ${totalCount} + ' products'"></span>
    </div>
    <div style="display: flex; gap: var(--wa-spacing-md); align-items: center;">
        <button class="button" 
                th:if="${page > 0}"
                th:hx-get="@{/products(sortBy=${sortBy}, order=${order}, page=${page - 1}, pageSize=${pageSize})}"
                hx-target="#product-table-container"
                hx-swap="innerHTML"
                style="padding: 0.5rem 1rem; font-size: 0.9rem;">
            Previous
        </button>
        <button class="button" 
                th:if="${page == 0}"
                disabled
                style="padding: 0.5rem 1rem; font-size: 0.9rem; opacity: 0.5; cursor: not-allowed;">
            Previous
        </button>
        <span th:text="'Page ' + ${page + 1} + ' of ' + ${totalPages}"></span>
        <button class="button"
                th:if="${page < totalPages - 1}"
                th:hx-get="@{/products(sortBy=${sortBy}, order=${order}, page=${page + 1}, pageSize=${pageSize})}"
                hx-target="#product-table-container"
                hx-swap="innerHTML"
                style="padding: 0.5rem 1rem; font-size: 0.9rem;">
            Next
        </button>
        <button class="button"
                th:if="${page >= totalPages - 1}"
                disabled
                style="padding: 0.5rem 1rem; font-size: 0.9rem; opacity: 0.5; cursor: not-allowed;">
            Next
        </button>
    </div>
</div>